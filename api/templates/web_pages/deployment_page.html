{%include "components/navbar_v2.html" %}
<body class="bg-blue-200">
    <div class="justify-center items-center flex flex-col">
        
        <h1 href="/project/new/deployment"  class="flex bg-sky-100 rounded-xl px-4 mb-3 text-2xl font-bold p-4 ml-4 leading-tight tracking-tight text-white md:text-2xl dark:text-black">Create New Deployment </h1>
        <div class="flex flex-col items-center bg-blue-400 rounded-xl p-4">
            <div class="flex flex-col items-center "></div>
            <input type="file" id="folder-input" webkitdirectory directory multiple class="border p-2 rounded-lg text-black font-bold mb-2">

            <button id="folder-upload-button" class="flex w-full hover:cursor-pointer mb-4 mt-3 ml-3 mr-3 transition-transform duration-300 hover:scale-110 justify-center items-center text-blue-100 bg-blue-800 hover:bg-blue-900 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-80">Upload Files</button>

            <div class="border-t border-white w-full mb-3 ">
                <button class="flex w-full hover:cursor-pointer mb-4 mt-5  mr-3 transition-transform duration-300 hover:scale-110 justify-center items-center text-blue-100 bg-blue-800 hover:bg-blue-900 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-80">Connect & Deploy from Github</button>
            </div>

        </div>    
    </div>
        </div>

    </div>


</body>
<script>
    const folderInput = document.getElementById('folder-input')
    const getfolder = document.getElementById('get-folder')
    const folder_button = document.getElementById('folder-upload-button')

    folder_button.addEventListener("click",()=>{
        const files = folderInput.click()
    })
    async function  evaluateConfigFile(fileObject,shipstack_config_dir="",){
        let configFIle;
        const files = fileObject.files
        const homedir = fileObject.files[0].webkitRelativePath.split("/")[0]
        let configFilePresent = false
        //yofojdwf im checking if the default shipstack config file is ther
        console.log(homedir)
        for (let i = 0;i < files.length;i++){
            console.log(files[i].webkitRelativePath)    
            if (files[i].webkitRelativePath == (`${homedir}/shipstack.config`)){
                configFilePresent = true
                raw_configFile = await getFileContents(files[i])
                console.log(shipstack_config_dir)
                console.log("dfdf",raw_configFile)
                configFile = JSON.parse(raw_configFile)

                //console.log("shipstack_config.json found")
            }
            else{
                //console.log("shipstack_config.json not found");
            }
        }
        if (configFilePresent == false){
            console.log("shipstack_config.json not found")
            alert("shipstack_config.json not found")
        }
        else{
            console.log("shipstack_config.json found")

            //alert("shipstack_config.json found")
        }
    }
    function getFileContents(file){
        return new Promise((resolve, reject) => {
            const reader = new FileReader()
            reader.onload = function(event){
                const fileContents = event.target.result
                console.log(fileContents)
                resolve(fileContents)
            }
            reader.onerror = function(event){
                console.error("Error reading file:", event)
                reject(event)
            }
            reader.readAsText(file)
        })
        

    }
</script>